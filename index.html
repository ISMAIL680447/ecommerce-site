<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel</title>

  <style>
    body { margin:0; font-family:Arial; background:#f4f6f9; }

    .sidebar {
      width:240px; height:100vh; background:#1e1e2d;
      color:white; position:fixed; padding:20px 10px;
    }
    .sidebar h2 { text-align:center; margin-bottom:25px; }
    .menu a {
      display:block; padding:12px 15px; margin:6px 0;
      color:white; text-decoration:none; border-radius:6px;
      font-size:15px; cursor:pointer;
    }
    .menu a:hover { background:#343446; }
    .active { background:#2874f0 !important; }

    .main { margin-left:250px; padding:20px; min-height:100vh; }

    .cards {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
      gap:20px;
    }
    .card {
      background:#fff; padding:20px; border-radius:10px;
      box-shadow:0 2px 5px rgba(0,0,0,0.1);
    }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { padding:12px; border-bottom:1px solid #ddd; text-align:left; }
    th { background:#eef1f5; }

    input, select {
      width:100%; padding:10px; margin:10px 0;
      border:1px solid #ccc; border-radius:6px;
    }
    .btn {
      background:#2874f0; padding:10px 15px; border:none;
      color:white; border-radius:6px; cursor:pointer;
    }
  </style>
</head>
<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>Admin</h2>
  <div class="menu">
    <a onclick="showPage('dashboard')" class="active">Dashboard</a>
    <a onclick="showPage('products')">Products</a>
    <a onclick="showPage('addProduct')">Add Product</a>
    <a onclick="showPage('orders')">Orders</a>
  </div>
</div>

<!-- MAIN AREA -->
<div class="main">

  <!-- DASHBOARD -->
  <div id="dashboard" class="page">
    <h1>Dashboard</h1>
    <div class="cards">
      <div class="card"><h3>Total Products</h3><p class="number">0</p></div>
      <div class="card"><h3>Total Orders</h3><p class="number">0</p></div>
      <div class="card"><h3>Total Users</h3><p class="number">0</p></div>
      <div class="card"><h3>Revenue</h3><p class="number">₹0</p></div>
    </div>
  </div>

  <!-- PRODUCTS PAGE -->
  <div id="products" class="page" style="display:none;">
    <h1>Products</h1>
    <table>
      <tr><th>Image</th><th>Title</th><th>Price</th><th>Category</th><th>Action</th></tr>
      <tbody id="productTable"></tbody>
    </table>
  </div>

  <!-- ADD PRODUCT PAGE -->
  <div id="addProduct" class="page" style="display:none;">
    <h1>Add Product</h1>

    <input type="text" id="pname" placeholder="Product Name" />
    <input type="text" id="pimg" placeholder="Image URL" />
    <input type="number" id="pprice" placeholder="Price" />

    <!-- Category FIXED -->
    <select id="pcategory">
      <option value="mobile">Mobiles</option>
      <option value="fashion">Fashion</option>
      <option value="electronics">Electronics</option>
      <option value="kitchen">Kitchen</option>
      <option value="beauty">Beauty</option>
    </select>

    <button class="btn" onclick="addProduct()">Add Product</button>
  </div>

  <!-- ORDERS PAGE -->
  <div id="orders" class="page" style="display:none;">
    <h1>Orders</h1>
    <table>
      <tr><th>Order ID</th><th>Customer</th><th>Total</th><th>Status</th></tr>
      <tbody id="orderTable"></tbody>
    </table>
  </div>

</div>

<script>
  // PAGE SWITCHING
  function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
    document.getElementById(id).style.display = 'block';

    document.querySelectorAll('.menu a').forEach(a => a.classList.remove('active'));
    event.target.classList.add('active');
  }

  // LOAD PRODUCTS
  function loadProducts() {
    let products = JSON.parse(localStorage.getItem('products') || '[]');
    let table = document.getElementById('productTable');
    table.innerHTML = '';

    products.forEach((p, i) => {
      table.innerHTML += `
        <tr>
          <td><img src="${p.img}" width="50"></td>
          <td>${p.name}</td>
          <td>₹${p.price}</td>
          <td>${p.category}</td>
          <td><button onclick="delProduct(${i})">Delete</button></td>
        </tr>`;
    });
  }

  // ADD PRODUCT (FIXED)
  function addProduct() {
    let name = document.getElementById('pname').value;
    let img = document.getElementById('pimg').value;
    let price = document.getElementById('pprice').value;
    let category = document.getElementById('pcategory').value;

    if(!name || !img || !price || !category)
      return alert('Please fill all fields');

    let products = JSON.parse(localStorage.getItem('products') || '[]');
    products.push({ name, img, price, category });
    localStorage.setItem('products', JSON.stringify(products));

    alert('Product Added Successfully!');
    loadProducts();
    showPage('products');
  }

  // DELETE PRODUCT
  function delProduct(i) {
    let products = JSON.parse(localStorage.getItem('products'));
    products.splice(i, 1);
    localStorage.setItem('products', JSON.stringify(products));
    loadProducts();
  }

  loadProducts();
</script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC9-TIDjZgx2YjMMU7S5MIQet1pxz6G73Y",
    authDomain: "mystore-5d7ce.firebaseapp.com",
    databaseURL: "https://mystore-5d7ce-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "mystore-5d7ce",
    storageBucket: "mystore-5d7ce.firebasestorage.app",
    messagingSenderId: "36974710146",
    appId: "1:36974710146:web:0086fe60572dc0b1c2539b"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // ADD PRODUCT using your actual IDs
  function addProduct() {
    let name = document.getElementById("pname").value;
    let img = document.getElementById("pimg").value;
    let price = document.getElementById("pprice").value;
    let category = document.getElementById("pcategory").value;

    if (!name || !img || !price || !category) {
      alert("Please fill all fields");
      return;
    }

    const productRef = ref(db, "products");
    const newRef = push(productRef);

    set(newRef, {
      id: newRef.key,
      name: name,
      img: img,
      price: price,
      category: category
    });

    alert("Product added successfully!");
    loadProducts();
    showPage('products');
  }

  // Override original function
  window.addProduct = addProduct;

  // LOAD PRODUCTS
  function loadProducts() {
    const productRef = ref(db, "products");
    const table = document.getElementById("productTable");

    onValue(productRef, (snapshot) => {
      table.innerHTML = "";
      snapshot.forEach((child) => {
        const p = child.val();
        table.innerHTML += `
          <tr>
            <td><img src="${p.img}" width="50"></td>
            <td>${p.name}</td>
            <td>₹${p.price}</td>
            <td>${p.category}</td>
            <td><button onclick="delProduct('${p.id}')">Delete</button></td>
          </tr>
        `;
      });
    });
  }
  loadProducts();

  // DELETE PRODUCT
  window.delProduct = function(id) {
    remove(ref(db, "products/" + id));
  };
</script>


</body>
</html>
